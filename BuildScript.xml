<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="create_run_jar" name="Create Runnable Jar for Project Simulus with Jar-in-Jar Loader">
    <!--this file was created by Eclipse Runnable JAR Export Wizard-->
    <!--ANT 1.7 is required                                        -->
	
	<target name="do-compile">
		<mkdir dir="bin"/>
		
		<javac includeantruntime="false" source="1.8" target="1.8" srcdir="src" destdir="bin" encoding="UTF-8"/>
		
		<!-- Copy resources -->
		<copy todir="bin/resources">
			<fileset dir="src/resources"/>
 		</copy>
		
		<!-- Copy non-Java files -->
		<copy todir="bin">
			<fileset dir="src">
				<exclude name="**/*.java"/>
			</fileset>
		</copy>	
	</target>
	
    <target name="create_run_jar" depends="clean,do-compile,javadoc">
        <jar destfile="deploy/Simulus.jar">
            <manifest>
                <attribute name="Main-Class" value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader"/>
                <attribute name="Rsrc-Main-Class" value="com.simulus.Startup"/>
                <attribute name="Class-Path" value="."/>
                <attribute name="Rsrc-Class-Path" value="./"/>
            </manifest>
            <zipfileset src="jar-in-jar-loader.zip"/>
            <fileset dir="bin"/>
        </jar>
 	
    		<copy todir="deploy/resources">
    			<fileset dir="src/resources">
    				<include name="default.map"/>
    				<include name="simulus.png"/>
    				<include name="logo1_small.png"/>
 				</fileset>	
    		</copy>
    </target>
	
	<target name="clean">
		<delete dir="deploy"/>
		<delete dir="bin"/>
	</target>
	
	<!-- Generate JavaDoc -->
	<target name="javadoc">	
		<javadoc
		     destdir="deploy/doc"
		     author="false"
		     version="true"
		     use="true"
		     windowtitle="Simulus Traffic Simulation - API">

		    <packageset dir="src" defaultexcludes="yes"/>
		     
		    <doctitle><![CDATA[<h1>Simulus Traffic Simulation - API</h1>]]></doctitle>
		  </javadoc>
	</target>
</project>
